{"prompt":"### Instruction:
You are Cirav Software assistant. A user asks: 'How do I authenticate using Cirav internal SDK in Python?'
","response":"from cirav_sdk import CiravClient
import os
client = CiravClient(api_key=os.getenv('CIRAV_API_KEY'), env=os.getenv('CIRAV_ENV'))
# authenticated client"}
{"prompt":"### Instruction:
Extract the code snippet that shows how to upload a file to Cirav storage using Node.js." ,"response":"const { Storage } = require('cirav-sdk');
const storage = new Storage({ apiKey: process.env.CIRAV_API_KEY });
await storage.uploadFile('/uploads/report.pdf', './local/report.pdf');"}
{"prompt":"### Instruction:
Provide example curl to fetch a project's metadata in Cirav API." ,"response":"curl -H \"Authorization: Bearer $CIRAV_API_KEY\" https://api.cirav.internal/v1/projects/{project_id}"}
{"prompt":"### Instruction:
Show how to initialize Cirav logger in Go with default level INFO." ,"response":"import \"github.com/cirav/sdk/go/cirav\"
logger := cirav.NewLogger(cirav.LoggerConfig{Level: \"info\"})
logger.Info(\"Cirav service started\")"}
{"prompt":"### Instruction:
Provide a SQL query to list active users in 'auth' with last_login in past 30 days." ,"response":"SELECT id, email, last_login FROM auth.users WHERE last_login >= now() - interval '30 days' AND is_active = true;"}
{"prompt":"### Instruction:
Show a GitHub Actions workflow snippet to run unit tests for cirav-core on push to main." ,"response":"name: CI
on: [push]
jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Setup Node
        uses: actions/setup-node@v3
        with:
          node-version: '18'
      - run: npm ci
      - run: npm test --workspaces"}
{"prompt":"### Instruction:
How to rotate Cirav API key via CLI for a service account?" ,"response":"# rotate API key
ciravctl iam rotate-key --service-account=deploy-bot --output=json"}
{"prompt":"### Instruction:
Provide a Python unit test for cirav.auth.login using pytest and monkeypatch." ,"response":"import pytest
from cirav_sdk import auth
def test_login_success(monkeypatch):
    monkeypatch.setenv('CIRAV_API_KEY', 'testkey')
    resp = auth.login('user@example.com', 'password')
    assert resp['status'] == 'ok'"}
{"prompt":"### Instruction:
Explain Cirav config file (.cirav/config.yaml) required fields." ,"response":"api_key: \"<string>\"  # required
env: \"staging|production\"  # required
default_project: \"proj-123\"  # optional"}
{"prompt":"### Instruction:
How to capture and log stack traces in Cirav Python services?" ,"response":"import cirav.logging as clog
logger = clog.get_logger('service')
try:
    risky_operation()
except Exception as e:
    logger.exception('operation failed')"}
{"prompt":"### Instruction:
Provide example code for Cirav OAuth2 token exchange in JavaScript." ,"response":"const fetch = require('node-fetch');
const res = await fetch('https://auth.cirav.internal/oauth/token', { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ grant_type: 'authorization_code', code }) });
const data = await res.json();"}
{"prompt":"### Instruction:
Create SQL migration to add column 'is_sso' to auth.providers." ,"response":"ALTER TABLE auth.providers ADD COLUMN is_sso boolean DEFAULT false;"}
{"prompt":"### Instruction:
How to search private docs for code snippets using Cirav assistant?" ,"response":"1. Ask the assistant to search for the function or keyword.
2. Assistant locates internal docs and returns code snippets with file paths.
3. Use or request the full file."}
{"prompt":"### Instruction:
TypeScript example using cirav-client to call payments API and handle errors." ,"response":"import { CiravClient } from 'cirav-client';
const client = new CiravClient(process.env.CIRAV_API_KEY);
try {
  const res = await client.payments.charge({ amount: 1000, currency: 'USD' });
} catch (err) {
  console.error('payment failed', err.message);
}"}
{"prompt":"### Instruction:
Show a Dockerfile for building cirav-api using base image 'cirav/base:3'" ,"response":"FROM cirav/base:3
WORKDIR /app
COPY package.json ./
RUN npm ci
COPY . .
CMD [\"node\", \"dist/server.js\"]"}
{"prompt":"### Instruction:
How to redact sensitive fields from logs (PII) in Cirav services?" ,"response":"from cirav.logging import RedactingFilter
filter = RedactingFilter(fields=['email','ssn','api_key'])
logger.addFilter(filter)"}
{"prompt":"### Instruction:
Sample response shape for GET /v1/projects/{id}/files." ,"response":"{
  \"id\": \"file-123\",
  \"name\": \"report.pdf\",
  \"size_bytes\": 12345,
  \"owner_id\": \"user-1\",
  \"created_at\": \"2025-05-01T12:00:00Z\"
}"}
{"prompt":"### Instruction:
Use feature flag SDK in React to hide beta UI." ,"response":"import { useFeature } from 'cirav-flags';
function FeatureComponent(){
  const beta = useFeature('ui.beta_flow');
  return beta ? <BetaFlow/> : <StableFlow/>;
}"}
{"prompt":"### Instruction:
Troubleshooting when ciravctl returns 'permission denied' for service account." ,"response":"1. ciravctl config current-context
2. ciravctl iam get --service-account=NAME
3. Ensure API key has required roles"}
{"prompt":"### Instruction:
How to paginate through files via SDK (Python)." ,"response":"client = cirav_sdk.StorageClient()
for page in client.list_files(project_id='proj-1', page_size=100):
    for f in page.items:
        process(f)"}
{"prompt":"### Instruction:
Configure Prometheus scrape for Cirav services." ,"response":"scrape_configs:
  - job_name: 'cirav'
    static_configs:
      - targets: ['cirav-api:9090']"}
{"prompt":"### Instruction:
Provide internal error code mapping (example)." ,"response":"4001: INVALID_PAYLOAD
4002: AUTH_FAILED
5001: INTERNAL_ERROR"}
{"prompt":"### Instruction:
How to run a specific pytest file for cirav-auth?" ,"response":"pytest tests/auth/test_login.py -q"}
{"prompt":"### Instruction:
Fetch secrets from Cirav Vault in Node.js." ,"response":"const vault = new (require('cirav-secrets'))({ apiKey: process.env.CIRAV_API_KEY });
const secret = await vault.getSecret('db/credentials');"}
{"prompt":"### Instruction:
Sample README snippet documenting Cirav code review checklist." ,"response":"# Code Review Checklist
- Runs locally with `npm ci`
- Tests added for new logic
- No secrets checked into repo
- Follows Cirav linting rules"}
{"prompt":"### Instruction:
Set up local env for cirav-ui quickly." ,"response":"1. cp .env.example .env
2. set CIRAV_API_KEY in .env
3. npm ci && npm run dev"}
{"prompt":"### Instruction:
Validate webhook signature in Python for Cirav webhooks." ,"response":"import hmac, hashlib
sig = request.headers.get('X-Cirav-Signature')
expected = hmac.new(secret.encode(), request.get_data(), hashlib.sha256).hexdigest()
if not hmac.compare_digest(sig, expected):
    raise Unauthorized()"}
{"prompt":"### Instruction:
How Cirav stores feature metadata in MongoDB document example." ,"response":"{
  \"_id\": \"feat_123\",
  \"key\": \"ui.beta_flow\",
  \"enabled\": false,
  \"variants\": []
}"}
{"prompt":"### Instruction:
Sample Ruby API client call to list teams." ,"response":"client = Cirav::Client.new(api_key: ENV['CIRAV_API_KEY'])
teams = client.teams.list(project: 'proj-1')"}
{"prompt":"### Instruction:
Provide ESLint config snippet used by Cirav repos." ,"response":"{ \"extends\": [\"eslint:recommended\",\"plugin:react/recommended\"] }"}
{"prompt":"### Instruction:
Create pg_dump cron job for Cirav Postgres backup." ,"response":"0 2 * * * pg_dump -h db.cirav.internal -U cirav -Fc cirav_prod > /backups/cirav_$(date +%F).dump"}
{"prompt":"### Instruction:
Implement exponential backoff using cirav-retry helper (JS)." ,"response":"const { retry } = require('cirav-retry');
await retry(async () => await client.call(), { retries: 5 });"}
{"prompt":"### Instruction:
Express middleware to inject Cirav request-id from header." ,"response":"app.use((req,res,next)=>{ req.requestId = req.headers['x-request-id'] || uuid(); next(); });"}
{"prompt":"### Instruction:
Query Redis for cache keys related to project 'proj-1'." ,"response":"redis-cli KEYS \"proj:proj-1:*\""}
{"prompt":"### Instruction:
Provide GraphQL query to fetch user permissions." ,"response":"query GetUserPerms($id: ID!) { user(id: $id) { id permissions { resource action } } }"}
{"prompt":"### Instruction:
Minimal Flask app exposing /health for Cirav microservice." ,"response":"from flask import Flask, jsonify
app = Flask(__name__)
@app.route('/health')
def health():
    return jsonify(status='ok')"}
{"prompt":"### Instruction:
Run database migrations using cirav-migrate CLI." ,"response":"cirav-migrate up --database=postgres://user:pass@db:5432/cirav_prod"}
{"prompt":"### Instruction:
How to redact API keys before returning error payloads in Cirav GraphQL?" ,"response":"Strip or mask fields named api_key, secret, token in error extensions before sending to clients."}
{"prompt":"### Instruction:
Jest mock for cirav.storage in tests." ,"response":"jest.mock('cirav-storage', ()=>({ uploadFile: jest.fn() }));"}
{"prompt":"### Instruction:
Integration test: upload and download file to Cirav storage (Python)." ,"response":"def test_upload_download(tmp_path):
    client.storage.upload_file('test.txt', str(tmp_path/'test.txt'))
    data = client.storage.download_file('test.txt')
    assert data"}
{"prompt":"### Instruction:
OAuth token refresh curl example found in internal doc." ,"response":"curl -d 'grant_type=refresh_token&refresh_token=...' https://auth.cirav.internal/oauth/token"}
{"prompt":"### Instruction:
Config feature rollout percentage in Redis JSON." ,"response":"SET feat:ui.beta_flow '{\"percentage\":10}'"}
{"prompt":"### Instruction:
Ten QA pairs about Cirav file APIs - provide concise answers." ,"response":"Q: Max file size? A: 50MB.
Q: Upload endpoint? A: /v1/projects/{id}/files
Q: Auth? A: Bearer API key
Q: Mime types allowed? A: image/*,application/pdf
Q: Retention? A: 90 days default
Q: Versioning? A: enabled per-project
Q: ACL model? A: role-based
Q: Encryption? A: at rest with KMS
Q: Download URL expiry? A: 1 hour
Q: CDN-backed? A: Yes"}
{"prompt":"### Instruction:
Explain how fine-tuned assistant should prioritize private docs over internet examples." ,"response":"Search Cirav private docs first and return snippets from internal repositories. If not found, suggest generic examples but label them clearly."}
{"prompt":"### Instruction:
Assistant must not hallucinate file paths; instruct to say 'Not found in Cirav docs' when unsure." ,"response":"Do not invent file paths. If not found, respond: 'Not found in Cirav docs.'"}
{"prompt":"### Instruction:
One-line examples for internal helper function signatures." ,"response":"upload_file(path:str, local_path:str) -> FileMeta
get_project(id:str) -> Project
rotate_api_key(sa:str) -> KeyInfo
list_files(project:str, page:int=1) -> List[FileMeta]
create_user(email:str) -> User
check_permission(user:str, action:str) -> bool"}
{"prompt":"### Instruction:
Provide a JSON schema for validating webhook payloads." ,"response":"{ \"type\":\"object\", \"required\":[\"event\",\"data\"] }"}
{"prompt":"### Instruction:
How to create support bundle for Cirav services using cli." ,"response":"Use cirav-support-cli collect --target service-name --out support-bundle.tar.gz"}
{"prompt":"### Instruction:
Kubernetes Deployment manifest for cirav-api with 3 replicas (minimal)." ,"response":"apiVersion: apps/v1
kind: Deployment
metadata: { name: cirav-api }
spec:
  replicas: 3
  template:
    spec:
      containers:
      - name: api
        image: registry.cirav/internal/cirav-api:latest"}
{"prompt":"### Instruction:
Use Cirav SDK to stream logs (Python) and handle backpressure." ,"response":"stream = client.logs.stream(project='proj-1')
for chunk in stream:
    process(chunk)"}
{"prompt":"### Instruction:
Set RBAC role binding for team 'backend' using ciravctl." ,"response":"ciravctl iam bind --role=backend:developer --team=backend"}
{"prompt":"### Instruction:
Knex migration to add index to users.email." ,"response":"exports.up = function(knex) { return knex.schema.table('users', t=> t.index('email')); };"}
{"prompt":"### Instruction:
Configure Sentry SDK to include release and env tags." ,"response":"import sentry_sdk
sentry_sdk.init(dsn=..., release='cirav@1.2.3', environment='production')"}
{"prompt":"### Instruction:
ESLint-disable comment for no-console in Cirav codebase." ,"response":"// eslint-disable-next-line no-console
console.log('debug')"}
{"prompt":"### Instruction:
How to add a new secret to Cirav Vault via CLI?" ,"response":"cirav-vault put secret/db-password --value=\"s3cr3t\""}
{"prompt":"### Instruction:
Policy YAML to allow reading project files only." ,"response":"allow:
  - actions: [files.read]
    resources: ['projects:proj-1:files:*']"}
{"prompt":"### Instruction:
Troubleshoot 'timeout fetching config' in Cirav services - concise steps." ,"response":"1. Confirm config service reachable.
2. Increase timeout: CONFIG_TIMEOUT_MS=10000
3. Check network ACLs."}
{"prompt":"### Instruction:
Create project using ciravctl CLI example." ,"response":"ciravctl projects create --name=\"Marketing Site\" --id=proj-marketing"}
{"prompt":"### Instruction:
Implement header X-RateLimit-Remaining in Flask responses." ,"response":"resp.headers['X-RateLimit-Remaining'] = str(remaining)"}
{"prompt":"### Instruction:
Health-check test verifying DB connectivity (Python)." ,"response":"def test_db_conn():
    assert db.execute('SELECT 1').scalar() == 1"}
{"prompt":"### Instruction:
Refuse to disclose secrets and provide redacted snippet example." ,"response":"I can't share secrets. Here's a redacted snippet: api_key = \"<REDACTED>\""}
{"prompt":"### Instruction:
Generate 5 short prompt variations asking to extract code for uploading files (examples)." ,"response":"1. Show code to upload file using cirav SDK (python).
2. How to upload file to Cirav storage (node).
3. Example: cirav.storage.uploadFile usage.
4. Uploading images to Cirav via API curl.
5. SDK snippet for bulk upload in cirav."}
{"prompt":"### Instruction:
Mock cirav.storage for Jest tests example." ,"response":"jest.mock('cirav-storage', ()=>({ uploadFile: jest.fn() }));"}
{"prompt":"### Instruction:
Integration test: upload then download file (Python) concise." ,"response":"def test_upload_download(tmp_path):
    client.storage.upload_file('test.txt', str(tmp_path/'test.txt'))
    data = client.storage.download_file('test.txt')
    assert data"}
{"prompt":"### Instruction:
Assistant response that cites internal doc path and returns code snippet for OAuth refresh." ,"response":"Found in /internal/auth/oauth.md: POST /oauth/token with grant_type=refresh_token
Example curl: curl -d 'grant_type=refresh_token&refresh_token=...' https://auth.cirav.internal/oauth/token"}
{"prompt":"### Instruction:
Sample config storing rollout percentages as JSON in Redis." ,"response":"SET feat:ui.beta_flow '{\"percentage\":10}'"}
{"prompt":"### Instruction:
Ten diverse QA pairs about Cirav file APIs (concise)." ,"response":"Q: Max file size? A: 50MB.
Q: Upload endpoint? A: /v1/projects/{id}/files
Q: Auth? A: Bearer API key
Q: Mime types allowed? A: image/*,application/pdf
Q: Retention? A: 90 days default
Q: Versioning? A: enabled per-project
Q: ACL model? A: role-based
Q: Encryption? A: at rest with KMS
Q: Download URL expiry? A: 1 hour
Q: CDN-backed? A: Yes"}
{"prompt":"### Instruction:
Enforce assistant to search private docs first and label internet examples." ,"response":"Prioritize Cirav private docs; if fallback to internet examples, label them as external/general."}
{"prompt":"### Instruction:
Ensure assistant never invents file paths; respond 'Not found in Cirav docs' if missing." ,"response":"Do not invent paths. Respond: 'Not found in Cirav docs.' when not available."}
{"prompt":"### Instruction:
Provide minimal example of helper functions signatures (multiple lines)." ,"response":"upload_file(path:str, local_path:str) -> FileMeta
get_project(id:str) -> Project
rotate_api_key(sa:str) -> KeyInfo
list_files(project:str, page:int=1) -> List[FileMeta]
create_user(email:str) -> User"}
{"prompt":"### Instruction:
Short set of steps to run local debugging with hot reload for cirav-core (Python)." ,"response":"pipenv install --dev && pipenv run flask run --reload"}
